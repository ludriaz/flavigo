<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Crear Nuevo Punto de Interés</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" th:href="@{/css/boostrap/bootstrap.min.css}">
<link rel="stylesheet" th:href="@{/css/boostrap/bootstrap-icons.css}">
<link rel="stylesheet" th:href="@{/css/admin-dashboard.css}">
<link rel="stylesheet" th:href="@{/css/tables-forms.css}">
<link rel="stylesheet" type="text/css"
	href="https://cdn.datatables.net/1.13.8/css/jquery.dataTables.min.css">
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


<script th:src="@{/js/sidebar.js}"></script>
<script>
    $(document).ready(function() {
        $('#tipo').change(function() {
            var tipoSeleccionado = $(this).val();
            $('#camposDinamicosModal').modal('show');
            cargarCamposDinamicos(tipoSeleccionado);
        });

        $('#guardarCamposDinamicos').click(function() {
            $('#camposDinamicosModal').modal('hide');
            // Los valores del modal se actualizarán directamente en el formulario antes del submit
        });

        $('form').submit(function() {
            // Antes de enviar, asegúrate de que los campos dinámicos correspondan al tipo seleccionado
            var tipoFinal = $('#tipo').val();
            $('.campo-dinamico').each(function() {
                var nombreCampo = $(this).attr('name');
                if (!nombreCampo.startsWith(tipoFinal + '_')) {
                    $(this).remove(); // Elimina campos que no coinciden con el tipo
                }
            });
            return true; // Permite el envío del formulario
        });

        function cargarCamposDinamicos(tipo) {
            var modalBody = $('#modal-body-campos-dinamicos');
            modalBody.empty(); // Limpia los campos anteriores
            if (tipo === 'Comercio') {
                modalBody.append(`
                    <div class="mb-3">
                        <label class="form-label">Categoría</label>
                        <select class="form-select campo-dinamico" name="Comercio_categoria">
                            <option value="MODA">Moda</option>
                            <option value="ALIMENTACION">Alimentación</option>
                            <option value="ELECTRONICA">Electrónica</option>
                            <option value="LIBRERIA">Librería</option>
                            <option value="DEPORTES">Deportes</option>
                            <option value="OTROS">Otros</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Productos Principales</label>
                        <textarea class="form-control campo-dinamico" name="Comercio_productos" rows="2"></textarea>
                    </div>
                `);
            } else if (tipo === 'Evento') {
                modalBody.append(`
                    <div class="mb-3">
                        <label class="form-label">Tipo de Evento</label>
                        <select class="form-select campo-dinamico" name="Evento_tipoEvento">
                            <option value="concierto">Concierto</option>
                            <option value="teatro">Teatro</option>
                            <option value="festival">Festival</option>
                            <option value="feria">Feria</option>
                            <option value="exposicion">Exposición</option>
                            <option value="conferencia">Conferencia</option>
                            <option value="cultural">Cultural</option>
                            <option value="deportivo">Deportivo</option>
                            <option value="educativo">Educativo</option>
                            <option value="musical">Musical</option>
                            <option value="gastronomico">Gastronómico</option>
                            <option value="fiesta_popular">Fiesta Popular</option>
                            <option value="otros">Otros</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Fecha Inicio</label>
                        <input type="datetime-local" class="form-control campo-dinamico" name="Evento_fechaInicio">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Fecha Fin</label>
                        <input type="datetime-local" class="form-control campo-dinamico" name="Evento_fechaFin">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Organizador</label>
                        <input type="text" class="form-control campo-dinamico" name="Evento_nombreOrganizador">
                    </div>
                `);
            } else if (tipo === 'Actividad') {
                modalBody.append(`
                    <div class="mb-3">
                        <label class="form-label">Tipo de Actividad</label>
                        <select class="form-select campo-dinamico" name="Actividad_tipoActividad">
                            <option value="deportiva">Deportiva</option>
                            <option value="cultural">Cultural</option>
                            <option value="aventura">Aventura</option>
                            <option value="relajante">Relajante</option>
                            <option value="gastronómica">Gastronómica</option>
                            <option value="turística">Turística</option>
                            <option value="otros">Otros</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Duración Aproximada (minutos)</label>
                        <input type="number" class="form-control campo-dinamico" name="Actividad_duracionAproximada" min="0">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Nivel</label>
                        <select class="form-select campo-dinamico" name="Actividad_nivel">
                            <option value="facil">Fácil</option>
                            <option value="medio">Medio</option>
                            <option value="dificil">Difícil</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Precio Entrada</label>
                        <input type="number" class="form-control campo-dinamico" name="Actividad_precioEntrada" step="0.01" min="0">
                    </div>
                `);
            } else if (tipo === 'Bar_Cafeteria') {
                modalBody.append(`
                    <div class="mb-3">
                        <label class="form-label">Ambiente</label>
                        <select class="form-select campo-dinamico" name="Bar_Cafeteria_ambiente">
                            <option value="tranquilo">Tranquilo</option>
                            <option value="familiar">Familiar</option>
                            <option value="moderno">Moderno</option>
                            <option value="tradicional">Tradicional</option>
                            <option value="festivo">Festivo</option>
                            <option value="romantico">Romántico</option>
                            <option value="otros">Otros</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Especialidades</label>
                        <textarea class="form-control campo-dinamico" name="Bar_Cafeteria_especialidades" rows="2"></textarea>
                    </div>
                `);
            } else if (tipo === 'Restaurante') {
                modalBody.append(`
                    <div class="mb-3">
                        <label class="form-label">Tipo de Cocina</label>
                        <select class="form-select campo-dinamico" name="Restaurante_tipoCocina">
                            <option value="TRADICIONAL">Tradicional</option>
                            <option value="MODERNA">Moderna</option>
                            <option value="INTERNACIONAL">Internacional</option>
                            <option value="FUSION">Fusión</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Menú Destacado</label>
                        <textarea class="form-control campo-dinamico" name="Restaurante_menuDestacado" rows="2"></textarea>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Rango de Precios</label>
                        <select class="form-select campo-dinamico" name="Restaurante_rangoPrecios">
                            <option value="BAJO">Bajo</option>
                            <option value="MEDIO">Medio</option>
                            <option value="ALTO">Alto</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Ambiente</label>
                        <select class="form-select campo-dinamico" name="Restaurante_ambiente">
                            <option value="tranquilo">Tranquilo</option>
                            <option value="familiar">Familiar</option>
                            <option value="moderno">Moderno</option>
                            <option value="tradicional">Tradicional</option>
                            <option value="festivo">Festivo</option>
                            <option value="romantico">Romántico</option>
                            <option value="otros">Otros</option>
                        </select>
                    </div>
                `);
            } else if (tipo === 'Alojamiento') {
                modalBody.append(`
                    <div class="mb-3">
                        <label class="form-label">Tipo de Alojamiento</label>
                        <select class="form-select campo-dinamico" name="Alojamiento_tipoAlojamiento">
                            <option value="hotel">Hotel</option>
                            <option value="hostal">Hostal</option>
                            <option value="pensión">Pensión</option>
                            <option value="apartamento">Apartamento</option>
                            <option value="camping">Camping</option>
                            <option value="albergue">Albergue</option>
                            <option value="otros">Otros</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Servicios</label>
                        <textarea class="form-control campo-dinamico" name="Alojamiento_servicios" rows="3"></textarea>
                    </div>
                `);
            } else if (tipo === 'Turistico') {
                modalBody.append(`
                    <div class="mb-3">
                        <label class="form-label">Tipo de Recurso Turístico</label>
                        <select class="form-select campo-dinamico" name="Turistico_tipoTuristico">
                            <option value="monumento">Monumento</option>
                            <option value="arquitectura">Arquitectura</option>
                            <option value="mirador">Mirador</option>
                            <option value="zona_natural">Zona Natural</option>
                            <option value="zona_arqueologica">Zona Arqueológica</option>
                            <option value="punto_emblematico">Punto Emblemático</option>
                            <option value="playa">Playa</option>
                            <option value="parque">Parque</option>
                            <option value="otros">Otros</option>
                        </select>
                    </div>
                `);
            } else if (tipo === 'PuntoInteres') {
                modalBody.append(`
                    <div class="mb-3">
                        <label class="form-label">Categoría</label>
                        <input type="text" class="form-control campo-dinamico" name="PuntoInteres_categoria">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Valoración Media</label>
                        <input type="number" class="form-control campo-dinamico" name="PuntoInteres_valoracion" step="0.1" min="0" max="5">
                    </div>
                `);
            }
        
            // Puedes añadir más condiciones 'else if' para otros tipos si necesitas campos adicionales
        }
    });
</script>

</head>
<body>
	<div th:insert="~{admin/fragmentos/sidebar :: sidebar}"></div>


	<div th:insert="~{admin/fragmentos/navbar :: navbar}"></div>
<div class="container mt-5">
    <h2>Crear Nuevo Punto de Interés</h2>
    <form th:action="@{/admin/PuntoInteres/Guardar}" method="post" enctype="multipart/form-data">

        <div class="mb-3">
            <label class="form-label">Nombre</label>
            <input type="text" class="form-control" name="nombre" required>
        </div>

        <div class="mb-3">
            <label class="form-label">Descripción breve</label>
            <textarea class="form-control" name="descripcionBreve" rows="2"></textarea>
        </div>

        <div class="mb-3">
            <label class="form-label">Descripción detallada</label>
            <textarea class="form-control" name="descripcionDetallada" rows="4"></textarea>
        </div>

        <div class="row mb-3">
            <div class="col-md-6">
                <label class="form-label">Latitud</label>
                <input type="number" step="0.0000001" class="form-control" name="latitud">
            </div>
            <div class="col-md-6">
                <label class="form-label">Longitud</label>
                <input type="number" step="0.0000001" class="form-control" name="longitud">
            </div>
        </div>

        <div class="row mb-3">
            <div class="col-md-4">
                <label class="form-label">Calle</label>
                <input type="text" class="form-control" name="calle">
            </div>
            <div class="col-md-4">
                <label class="form-label">Número</label>
                <input type="text" class="form-control" name="numero">
            </div>
            <div class="col-md-4">
                <label class="form-label">Localidad</label>
                <input type="text" class="form-control" name="localidad">
            </div>
        </div>

        <div class="mb-3">
            <label class="form-label">URL</label>
            <input type="url" class="form-control" name="url">
        </div>

        <div class="mb-3">
            <label class="form-label">Imagen</label>
            <input type="file" class="form-control" name="imagen">
            <small class="form-text text-muted">Selecciona una imagen para subir.</small>
        </div>

        <div class="row">
            <div class="col-md-3 mb-3">
                <label class="form-label">Apertura mañana</label>
                <input type="time" class="form-control" name="horarioAperturaManana">
            </div>
            <div class="col-md-3 mb-3">
                <label class="form-label">Cierre mañana</label>
                <input type="time" class="form-control" name="horarioCierreManana">
            </div>
            <div class="col-md-3 mb-3">
                <label class="form-label">Apertura tarde</label>
                <input type="time" class="form-control" name="horarioAperturaTarde">
            </div>
            <div class="col-md-3 mb-3">
                <label class="form-label">Cierre tarde</label>
                <input type="time" class="form-control" name="horarioCierreTarde">
            </div>
        </div>

        <div class="mb-3">
            <label class="form-label">Etiquetas</label>
            <textarea class="form-control" name="etiquetas" rows="2"></textarea>
        </div>

        <div class="mb-3">
            <label class="form-label">Teléfono</label>
            <input type="text" class="form-control" name="telefono">
        </div>

        <div class="mb-3">
            <label class="form-label">Tipo</label>
            <select class="form-select" id="tipo" name="tipo">
                <option th:each="tipo : ${tipos}"
                        th:value="${tipo.name()}"
                        th:text="${tipo}">
                </option>
            </select>
        </div>

        <div id="contenedorCamposDinamicos">
            </div>

        <button type="submit" class="btn btn-primary">Guardar</button>
        <a th:href="@{/admin/PuntoInteres/ConsultarPuntoInteres}" class="btn btn-secondary">Cancelar</a>
    </form>
</div>

<div class="modal fade" id="camposDinamicosModal" tabindex="-1" aria-labelledby="camposDinamicosModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="camposDinamicosModalLabel">Detalles Adicionales</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="modal-body-campos-dinamicos">
                </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-primary" id="guardarCamposDinamicos">Guardar</button>
            </div>
        </div>
    </div>
</div>

</body>
</html>